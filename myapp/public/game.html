<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MasterMind</title>
    

  </head>
  <body>

    <div class = "logo">
        <img src = "images/MasterMindLogo.png">
        <h1>MasterMind</h1>
    </div>

    <div class = "stats">
        <p>Time played:     x</p>
        <p>Guesses left:    x</p>
        <p>Status: <span class = "status"></span></p>
    </div>

    
    <div class = "board">
        <div class = "rate">
            <form class = "rateGuessForm">
                <ul class = "rateGuess"></ul>
                <input type = "button" value = "Submit rating" class = "rateGuessSubmit" hidden = "true">
            </form>
        </div>
        <div class = "previousGuesses">
            <div class = "prevGuess">
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "rating">r</div>
            </div>
            <div class = "prevGuess">
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "rating">r</div>
            </div>
            <div class = "prevGuess">
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "rating">r</div>
            </div>
            <div class = "prevGuess">
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "rating">r</div>
            </div>
            <div class = "prevGuess">
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "rating">r</div>
            </div>
            <div class = "prevGuess">
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "rating">r</div>
            </div>
            <div class = "prevGuess">
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "rating">r</div>
            </div>
            <div class = "prevGuess">
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "rating">r</div>
            </div>
            <div class = "prevGuess">
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "rating">r</div>
            </div>
            <div class = "prevGuess">
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "hole">h</div>
                <div class = "rating">r</div>
            </div>
        </div>

        <div class = "currentGuess">
            <form class = "formGuess">
                <select id = "hole1" name = "hole1">
                    <option value = "red">          red         </option>
                    <option value = "orange">       orange      </option>
                    <option value = "yellow">       yellow      </option>
                    <option value = "green">        green       </option>
                    <option value = "lightblue">    lightblue   </option>
                    <option value = "blue">         blue        </option>
                    <option value = "purple">       purple      </option>
                    <option value = "pink">         pink        </option>
                </select>
                <select id = "hole2" name = "hole2">
                    <option value = "red">          red         </option>
                    <option value = "orange">       orange      </option>
                    <option value = "yellow">       yellow      </option>
                    <option value = "green">        green       </option>
                    <option value = "lightblue">    lightblue   </option>
                    <option value = "blue">         blue        </option>
                    <option value = "purple">       purple      </option>
                    <option value = "pink">         pink        </option>
                </select>
                <select id = "hole3" name = "hole3">
                    <option value = "red">          red         </option>
                    <option value = "orange">       orange      </option>
                    <option value = "yellow">       yellow      </option>
                    <option value = "green">        green       </option>
                    <option value = "lightblue">    lightblue   </option>
                    <option value = "blue">         blue        </option>
                    <option value = "purple">       purple      </option>
                    <option value = "pink">         pink        </option>
                </select>
                <select id = "hole4" name = "hole4">
                    <option value = "red">          red         </option>
                    <option value = "orange">       orange      </option>
                    <option value = "yellow">       yellow      </option>
                    <option value = "green">        green       </option>
                    <option value = "lightblue">    lightblue   </option>
                    <option value = "blue">         blue        </option>
                    <option value = "purple">       purple      </option>
                    <option value = "pink">         pink        </option>
                </select>
                <input type = "button" value = "Submit" class = "guessSubmit">
            </form>
        </div>
        <div class = "pins">
            <div class = "red">red</div>
            <div class = "orange">orange</div>
            <div class = "yellow">yellow</div>
            <div class = "green">green</div>
            <div class = "lightblue">lightblue</div>
            <div class = "blue">blue</div>
            <div class = "purple">purple</div>
            <div class = "pink">pink</div>
        </div>
    </div>
    
    
    <script>
        const target = document.querySelector(".status");
        const socket = new WebSocket("ws://localhost:3000");
        
        const board = document.querySelector(".board");
        board.hidden = true;

        document.querySelector(".guessSubmit").onclick = function() {
            let hole1 = document.getElementById("hole1");
            let hole2 = document.getElementById("hole2");
            let hole3 = document.getElementById("hole3");
            let hole4 = document.getElementById("hole4");
            let guess = [hole1.value, hole2.value, hole3.value, hole4.value];
            socket.send("Guess = " + guess.toString());
        }

        socket.onmessage = function(event) {
            target.innerHTML = event.data;
            let player;

            if(event.data.includes("You are player 1")){
                player = 1;
                document.querySelector(".guessSubmit").hidden = true;
            }            
            if(event.data.includes("You are player 2")) {
                player = 2; 
            } 

            if(event.data.includes("game is starting...")){
                board.hidden = false;
            }

            if(event.data.includes("Guess = ")){
                let guess = event.data.substring(8); 
                let guessArray = guess.split(",");

                const rateGuess = document.querySelector(".rateGuess");
                const rateGuessForm = document.querySelector(".rateGuessForm");

                const rateGuess1 = document.createElement("li");
                const rateGuess2 = document.createElement("li");
                const rateGuess3 = document.createElement("li");
                const rateGuess4 = document.createElement("li");

                let select1 = document.createElement("select")
                select1.name = "rating1";
                select1.id = "rating1";

                let option = document.createElement("option");
                option.value = "5";
                option.text = "Green";
                select1.appendChild(option);
                option = document.createElement("option");
                option.value = "1";
                option.text = "Yellow";
                select1.appendChild(option);
                option = document.createElement("option");
                option.value = "0";
                option.text = "Red";
                select1.appendChild(option);

                let select2 = select1.cloneNode(true);
                let select3 = select1.cloneNode(true);
                let select4 = select1.cloneNode(true);

                // let select2 = document.createElement("select")
                // select2.name = "rating2";
                // select2.id = "rating2";

                // let option = document.createElement("option");
                // option.value = "5";
                // option.text = "Green";
                // select2.appendChild(option);
                // option = document.createElement("option");
                // option.value = "1";
                // option.text = "Yellow";
                // select2.appendChild(option);
                // option = document.createElement("option");
                // option.value = "0";
                // option.text = "Red";
                // select2.appendChild(option);

                // let select3 = document.createElement("select")
                // select3.name = "rating3";
                // select3.id = "rating3";

                // let option = document.createElement("option");
                // option.value = "5";
                // option.text = "Green";
                // select3.appendChild(option);
                // option = document.createElement("option");
                // option.value = "1";
                // option.text = "Yellow";
                // select3.appendChild(option);
                // option = document.createElement("option");
                // option.value = "0";
                // option.text = "Red";
                // select3.appendChild(option);

                // let select4 = document.createElement("select")
                // select4.name = "rating4";
                // select4.id = "rating4";

                // let option = document.createElement("option");
                // option.value = "5";
                // option.text = "Green";
                // select4.appendChild(option);
                // option = document.createElement("option");
                // option.value = "1";
                // option.text = "Yellow";
                // select4.appendChild(option);
                // option = document.createElement("option");
                // option.value = "0";
                // option.text = "Red";
                // select4.appendChild(option);

                rateGuess1.innerHTML = guessArray[0];
                rateGuess1.appendChild(select1);
                rateGuess2.innerHTML = guessArray[1];
                rateGuess2.appendChild(select2);
                rateGuess3.innerHTML = guessArray[2];
                rateGuess3.appendChild(select3);
                rateGuess4.innerHTML = guessArray[3];
                rateGuess4.appendChild(select4);

                rateGuess.appendChild(rateGuess1);
                rateGuess.appendChild(rateGuess2);
                rateGuess.appendChild(rateGuess3);
                rateGuess.appendChild(rateGuess4);

                document.querySelector(".rateGuessSubmit").hidden = false;


                // const guessPar = document.querySelector(".rateGuess");
                // guessPar.textContent = guess;
            }
        }

        socket.onopen = function() {
            socket.send("Attempting to join");
            target.innerHTML = "Attempting to join...";
        }
    </script>

  </body>
</html>
